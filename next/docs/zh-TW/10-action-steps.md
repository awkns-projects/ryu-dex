# 動作步驟

## 概覽

動作步驟是組成動作的個別操作。每個步驟執行特定任務：AI 推理、圖像生成、API 呼叫或資料操作。

## 步驟類型

### 1. AI 推理步驟
### 2. AI 圖像生成步驟
### 3. API 執行步驟
### 4. 資料操作步驟

## AI 推理步驟

### 目的

AI 推理步驟使用語言模型來：
- 生成文字內容
- 分析和提取資訊
- 轉換資料
- 做出智慧決策
- 分類和歸類

### 配置

```
步驟配置：
  名稱：生成行銷文案
  類型：AI 推理
  模型：GPT-4
  溫度：0.7
  最大令牌數：1000
```

### 模型選擇

**GPT-4**（預設）
- 最佳品質
- 複雜推理
- 更長上下文
- 更高成本

**GPT-3.5-Turbo**
- 快速回應
- 良好品質
- 較低成本
- 較短上下文

### 溫度設定

```
溫度：0.0-0.3（專注、確定性）
  用於：
    - 資料提取
    - 分類
    - 結構化輸出
    - 基於事實的內容
  
溫度：0.4-0.7（平衡）
  用於：
    - 一般內容
    - 行銷文案
    - 產品描述
    - 部落格文章
  
溫度：0.8-1.0（創意）
  用於：
    - 創意寫作
    - 腦力激盪
    - 藝術內容
    - 多樣化輸出
```

## AI 圖像生成步驟

### 目的

使用以下工具從文字描述生成圖像：
- DALL-E 3
- Midjourney
- Stable Diffusion
- 其他圖像生成模型

### 配置

```
步驟配置：
  名稱：生成精選圖像
  類型：AI 圖像生成
  模型：DALL-E 3
  大小：1792x1024（16:9）
  品質：HD | 標準
  風格：自然 | 生動
  圖像數量：1-4
```

### 大小選項

```
DALL-E 3 大小：
  - 1024x1024（正方形）
  - 1792x1024（橫向）
  - 1024x1792（縱向）

Stable Diffusion 大小：
  - 512x512
  - 768x768
  - 512x768
  - 768x512
  - 自訂（有限制）
```

### 提示工程

**有效的圖像提示**

```
基本：
  「現代辦公室工作區」

增強：
  「現代辦公室工作區的專業照片，
   來自大窗戶的自然日光，極簡設計，
   帶筆記型電腦和咖啡的木桌，室內植物，
   淺景深，簡潔美學，4k 品質」
```

## API 執行步驟

### 目的

與外部服務互動：
- 在社交媒體上發布內容
- 從 API 獲取資料
- 觸發 webhook
- 與外部系統同步
- 更新第三方服務

### HTTP 方法

#### GET 請求
```
步驟：獲取使用者資料

方法：GET
URL：https://api.example.com/users/{userId}
標頭：
  Authorization：Bearer {oauth_token}
  Content-Type：application/json

回應映射：
  response.data.name → 使用者.name
  response.data.email → 使用者.email
```

#### POST 請求
```
步驟：建立社交貼文

方法：POST
URL：https://api.instagram.com/v1/media
主體：
  {
    "caption": "{社交貼文.caption}",
    "image_url": "{社交貼文.imageUrl}"
  }

回應映射：
  response.id → 社交貼文.externalId
```

## 資料操作步驟

### 建立記錄

```
步驟：建立子貼文

類型：建立記錄
目標模型：社交貼文

欄位值：
  sourceArticle：{當前記錄 ID}
  platform：「Instagram」
  status：「草稿」

輸出：
  新記錄 ID → 文章.lastChildId
```

### 更新記錄

```
步驟：標記為已處理

類型：更新記錄
目標：當前記錄

更新：
  status：「已完成」
  processedAt：{當前時間戳記}
```

## 步驟鏈接和相依性

### 順序步驟

```
動作：完整內容管道

步驟 1：AI 推理
  生成社交說明
  輸出 → caption 欄位

步驟 2：AI 圖像生成
  使用 → caption 作為靈感
  輸出 → imageUrl 欄位

步驟 3：API 執行
  使用 → caption 和 imageUrl
  發布到 Instagram
  輸出 → externalId

步驟 4：資料更新
  使用 → externalId
  更新 → status = "已發布"
```

## 錯誤處理

### 步驟層級錯誤

```
步驟配置：
  出錯時：
    - 繼續到下一步
    - 停止整個動作
    - 執行後備步驟
    - 重試 N 次

  錯誤記錄：
    - 記錄到欄位：記錄.errorLog
    - 傳送通知：email@example.com
    - 觸發 webhook：https://...
```

## 最佳實踐

### AI 步驟

- 使用具體、詳細的提示
- 包含範例以保持一致性
- 設定適當的溫度
- 驗證輸出
- 處理邊緣情況

### 圖像生成

- 使用描述性提示
- 指定風格和構圖
- 包含技術細節
- 選擇適當的大小
- 考慮生成時間

### API 步驟

- 正確處理認證
- 實施重試邏輯
- 尊重速率限制
- 仔細解析回應
- 全面記錄錯誤

## 下一步

- [動作](./09-actions.md) - 了解動作工作流程
- [API 連接](./11-api-connections.md) - 設定整合
- [排程](./12-scheduling.md) - 自動化步驟執行
- [最佳實踐](./14-best-practices.md) - 優化技術
