# 工作區

## 概覽

工作區是代理內的組織容器，它們將相關模型分組並管理 API 連接。每個工作區為特定專案、活動或功能區域提供一個獨立的環境。

## 什麼是工作區？

**工作區**是：
- 相關模型的集合
- API 連接的容器
- 資料關聯的範圍
- 代理內的組織邊界

將工作區視為您更大代理中的「子專案」或「環境」。

## 工作區架構

```
工作區：社交媒體活動
  ├── 模型
  │    ├── 內容日曆
  │    ├── 社交貼文
  │    ├── 分析
  │    └── 主題標籤
  ├── API 連接
  │    ├── Facebook
  │    ├── Instagram
  │    ├── Twitter
  │    └── LinkedIn
  └── 共享資源
       ├── 全域欄位
       └── 跨模型動作
```

## 建立工作區

### 基本設定

**必要資訊**：
- **名稱**：描述性識別符
- **描述**：目的和範圍
- **父代理**：它屬於哪個代理

**範例**：
```
名稱：Q4 假期活動
描述：管理 Q4 假期行銷的所有內容和自動化
代理：行銷自動化代理
```

### 配置選項

**設定**：
- **預設時區**：用於排程和日期
- **預設貨幣**：用於財務欄位
- **封存政策**：保留舊記錄多長時間
- **存取控制**：誰可以檢視/編輯

## 工作區 vs. 代理

### 何時使用工作區

使用新工作區用於：
- ✅ 不同的活動（Q1 活動、Q2 活動）
- ✅ 不同的環境（生產、預備）
- ✅ 不同的客戶（在同一業務內）
- ✅ 不同的專案（專案 A、專案 B）
- ✅ 相關但獨立的工作流程

### 何時使用新代理

使用新代理用於：
- ✅ 完全不同的業務功能
- ✅ 嚴格的資料隔離要求
- ✅ 不同的權限結構
- ✅ 獨立的產品或服務

## 工作區元件

### 1. 模型

模型定義工作區內的資料結構。

**行銷工作區中的範例模型**：
```
- 部落格貼文
- 社交媒體貼文
- 電子郵件活動
- 潛在客戶清單
- 分析報告
```

### 2. API 連接

每個工作區管理自己的 API 連接，但有一個重要限制：

**每種 API 類型一個連接**

您可以有：
- ✅ 一個 Facebook 連接
- ✅ 一個 Instagram 連接
- ✅ 一個 Google Sheets 連接
- ✅ 一個 Airtable 連接

您不能有：
- ❌ 兩個 Facebook 連接
- ❌ 多個 Instagram 帳戶
- ❌ 不同模型的不同 Google 帳戶

**為什麼有這個限制？**

這確保了：
- 連接的明確所有權
- 簡化的 OAuth 管理
- 可預測的資料流
- 降低配置複雜性

**多個帳戶的解決方法**：

如果您需要同一服務的多個帳戶：
```
建立獨立的工作區：
  - 工作區 1：Facebook 帳戶 A
  - 工作區 2：Facebook 帳戶 B
```

### 3. 全域欄位概念

在工作區內，所有模型欄位都可被所有動作存取。這就是我們所說的「全域工作區欄位」。

**範例**：
```
工作區：內容中心

模型 A：文章
  - 標題
  - 內容
  - 作者

模型 B：社交貼文
  - 平台
  - 貼文文字
  - 圖像 URL

模型 B 中的動作可以使用：
  - 模型 B 欄位（平台、貼文文字、圖像 URL）
  - 模型 A 欄位（標題、內容、作者）
  
這使模型 A 欄位在工作區內成為「全域」
```

## 工作區使用案例

### 按環境

#### 生產工作區
```
目的：實時、面向客戶的自動化
配置：
  - 真實 API 連接
  - 生產資料
  - 完整錯誤處理
  - 啟用監控
```

#### 預備工作區
```
目的：生產前測試
配置：
  - 測試 API 連接
  - 範例資料
  - 詳細日誌
  - 允許實驗
```

#### 開發工作區
```
目的：建立和測試新功能
配置：
  - 模擬 API 連接
  - 合成資料
  - 快速迭代
  - 允許重大變更
```

### 按活動

#### Q1 活動工作區
```
模型：
  - 活動內容
  - 廣告創意
  - 效能指標
  - 預算追蹤

時間表：1 月 1 日 - 3 月 31 日
狀態：已完成（已封存）
```

#### Q2 活動工作區
```
模型：
  - 活動內容
  - 廣告創意
  - 效能指標
  - 預算追蹤

時間表：4 月 1 日 - 6 月 30 日
狀態：活躍
```

### 按客戶

#### 客戶 A 工作區
```
目的：管理客戶 A 的社交媒體
API 連接：
  - 客戶 A 的 Facebook
  - 客戶 A 的 Instagram
  - 客戶 A 的 LinkedIn

模型：
  - 內容日曆
  - 已發布貼文
  - 分析
```

#### 客戶 B 工作區
```
目的：管理客戶 B 的社交媒體
API 連接：
  - 客戶 B 的 Facebook
  - 客戶 B 的 Instagram
  - 客戶 B 的 LinkedIn

模型：
  - 內容日曆
  - 已發布貼文
  - 分析
```

## 處理全域工作區欄位

### 理解範圍

**本地範圍（模型層級）**：
```javascript
// 「社交貼文」模型中的動作可以直接存取：
{
  platform: "Instagram",
  postText: "看看我們的新產品！",
  imageUrl: "https://..."
}
```

**全域範圍（工作區層級）**：
```javascript
// 相同的動作也可以存取「文章」模型的欄位：
{
  // 來自社交貼文（本地）
  platform: "Instagram",
  postText: "",
  
  // 來自文章模型（全域工作區欄位）
  articleTitle: "更好行銷的 10 個技巧",
  articleContent: "Lorem ipsum...",
  articleAuthor: "Jane Doe"
}

// 動作可以使用文章欄位來生成社交貼文
```

### 實際範例

**工作區**：內容製作

**模型 1**：部落格文章
```
欄位：
  - id
  - title
  - content
  - publishedDate
  - author
```

**模型 2**：社交貼文
```
欄位：
  - id
  - sourceArticle（關聯到部落格文章）
  - platform
  - postText
  - scheduledTime
```

**動作**：「從文章生成社交貼文」
```
位置：社交貼文模型

輸入：
  - 全域：部落格文章.title
  - 全域：部落格文章.content
  - 本地：社交貼文.platform

處理：
  AI 提示：「為 {platform} 建立關於 '{title}' 的貼文，來自此內容：{content}」

輸出：
  - 本地：社交貼文.postText
```

## API 連接管理

### 連接 API

1. **導航到工作區設定**
2. **選擇「新增連接」**
3. **選擇 API 提供者**
   - Facebook
   - Instagram
   - Twitter/X
   - LinkedIn
   - Google Sheets
   - Airtable
   - Notion
   - 自訂 API

4. **使用 OAuth 授權**
   - 重新導向到提供者
   - 授予權限
   - 返回平台

5. **配置設定**
   - 選擇帳戶（如果有多個）
   - 設定權限範圍
   - 測試連接

### 連接配置

```
連接：Instagram
類型：社交媒體
OAuth 狀態：已連接
帳戶：@mybusiness
權限：
  - 發布內容
  - 讀取分析
  - 管理評論
最後使用：2025-10-20 10:30 AM
狀態：活躍
```

### 在動作中使用連接

建立帶有 API 步驟的動作時：

```
步驟：發布到 Instagram

連接：（從工作區連接中選擇）
  → Instagram (@mybusiness)

端點：POST /media

資料：
  image_url: {圖像 URL 欄位}
  caption: {說明欄位}
```

### 連接限制

**每個工作區**：
- 每個 API 提供者類型一個連接
- 無限總連接數（不同提供者）
- OAuth 令牌自動管理
- 平台處理刷新令牌

**範例有效配置**：
```
工作區連接：
  ✅ Facebook (1)
  ✅ Instagram (1)
  ✅ Twitter (1)
  ✅ LinkedIn (1)
  ✅ Google Sheets (1)
  ✅ Airtable (1)
總計：6 個連接
```

**範例無效配置**：
```
工作區連接：
  ❌ Facebook 帳戶 A
  ❌ Facebook 帳戶 B
錯誤：每個工作區只允許一個 Facebook 連接
```

### 斷開 API

要斷開 API：
1. 導航到工作區連接
2. 選擇連接
3. 點擊「斷開連接」
4. 確認操作

**影響**：
- 使用此連接的所有動作將失敗
- 排程作業將出錯
- OAuth 令牌被撤銷
- 可以稍後重新建立連接

## 跨模型關聯

### 連結模型

工作區內的模型可以相互參照：

```
模型：部落格文章
  id: 1
  title: "如何使用 AI"
  content: "..."

模型：社交貼文
  id: 101
  sourceArticle: 1（→ 部落格文章）
  platform: "Instagram"
  postText: "查看我們的文章..."
```

### 建立子記錄

動作可以在相關模型中建立記錄：

```
動作：「將文章分發到社交」

位置：部落格文章模型

步驟：
  1. 提取標題和摘要
  2. 建立 Instagram 貼文（在社交貼文模型中建立子記錄）
  3. 建立 Twitter 貼文（在社交貼文模型中建立子記錄）
  4. 建立 LinkedIn 貼文（在社交貼文模型中建立子記錄）

結果：
  一篇部落格文章 → 三個社交貼文
```

### 參照全域欄位

動作可以讀取和寫入工作區中的任何模型：

```
動作：「更新分析」

位置：社交貼文模型

輸入：
  - 社交貼文.platform
  - 社交貼文.sourceArticle.title（來自部落格文章）
  
處理：
  從 API 獲取分析
  
輸出：
  - 部落格文章.totalShares（更新父記錄）
  - 社交貼文.likes（更新當前記錄）
```

## 工作區組織最佳實踐

### 命名慣例

**好的工作區名稱**：
- 2025 年 Q4 假期活動
- 生產環境
- 客戶服務 - Acme Corp
- Instagram 內容中心
- 電子郵件自動化系統

**不好的工作區名稱**：
- 工作區 1
- 測試
- 新的
- 未命名

### 組織策略

**當工作區變得太大時**：
- 考慮拆分為多個工作區
- 封存舊資料
- 為新活動建立新工作區
- 使用關聯保持連接

**工作區需要拆分的跡象**：
- 超過 15-20 個模型
- 不相關的工作流程
- 不同團隊管理不同部分
- 效能下降

## 下一步

- [模型與表單](./06-models-and-sheets.md) - 定義您的資料結構
- [API 連接](./11-api-connections.md) - 深入探討整合
- [動作](./09-actions.md) - 使用全域欄位建立工作流程
- [最佳實踐](./14-best-practices.md) - 優化工作區設計

